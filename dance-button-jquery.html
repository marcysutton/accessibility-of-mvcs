<!DOCTYPE html>
<html>
<head>
  <title>x-gif demo</title>
  <script>
    if ('registerElement' in document
      && 'createShadowRoot' in HTMLElement.prototype
      && 'import' in document.createElement('link')
      && 'content' in document.createElement('template')) {
      // We're using a browser with native WC support!
    } else {
      document.write('<script src="https:\/\/cdnjs.cloudflare.com/ajax/libs/polymer/0.3.4/platform.js"><\/script>')
    }
  </script>
  <script src="demos/shared/js/lib/angular.min.js"></script>
  <script src="lib/js/jquery-1.11.1.min.js"></script>
  <link rel="import" href="demos/x-gif/x-gif.html">
  <link rel="stylesheet" href="css/reveal.min.css">
  <link rel="stylesheet" href="css/theme/marcysutton.css">
  <style>
    html, body {
      height: 100%;
      min-height: 100%;
      overflow: visible;
    }
    audio {
      position: absolute;
      left: -500000px;
    }
    .reveal {
      z-index: 2;
      text-align: center;
    }
    x-gif {
      bottom: 0;
      left: 0;
      position: absolute;
      right: 0;
      top: 0;
    }
    x-gif #frames {
      height: 100%;
      width: 100%;
    }
    x-gif img {
      height: 100vh;
      width: 100vw;
    }
  </style>
</head>
<body>
<div class="reveal" ng-init="buttonPressed = false">
  <div class="inset-width text-background" style="margin-top: 0;">
    <h2>Everybody dance!</h2>
    <pre><code class="html">
  &lt;div role="button" tabIndex="0"
  ng-click="oneTwoThree(go)"
  ng-keypress="oneTwoThree(go)"&gt;
  DANCE!
  &lt;/div&gt;
    </code></pre>
    <button class="themed-button image-show" aria-label="Dance">DANCE!</button>
    <div>
      <button class="reset disabled" aria-label="Rest" ng-show="buttonPressed == true">Rest</button>
    </div>
  </div>
</div>
<div class="offscreen" style="overflow: hidden;">
  <audio controls preload>
    <source src="demos/x-gif/get_down_on_it.ogg" type="audio/ogg">
    <source src="demos/x-gif/get_down_on_it.mp3" type="audio/mpeg">
  </audio>
</div>
<div class="offscreen">Loading beat data...</div>
<x-gifclass="x-gif-synced-demo" src="http://i.imgur.com/KhQ4THw.gif" sync loop></x-gif>
<script src="demos/x-gif/synched_playback.js"></script>
<script charset="utf-8">
  $(document).ready(function(){
    var scope = this;

    var xGif = '.x-gif-synced-demo';

    var gifs = [
      "http://i.imgur.com/KhQ4THw.gif"
    ];
    var gif = {
      url: gifs[0],
      speed: 2,
      bpm: 60,
      playbackRate: 1,
      nTimes: 1.0
    };
    var audio = document.querySelector('audio'),
        resetButton = $('button.reset'),
        showButton = $('button.image-show');

    $.get('demos/x-gif/get_down_on_it.json').then(function (response) {
      gif.metadata = response;
      console.log(gif.metadata);
      setupAudioSynching(audio,
        document.querySelectorAll(xGif),
        gif.metadata)
    });

    showButton.on('click', function(){
      console.log('DANCE!!!!');
      audio.play();
      resetButton.attr({'tabIndex':'0', 'aria-hidden':'false'}).removeClass('disabled')
      window.setTimeout(function(){
        resetButton.focus();
      }, 100);
    });
    resetButton.on('click', function(e){
      console.log('reset');
      audio.pause();
      $(this).attr({'tabIndex':'-1', 'aria-hidden':'true'}).addClass('disabled');
      showButton.focus();
    });
  });
</script>
</body>
</html>
